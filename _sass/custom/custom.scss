// =============================================================================
// MERMAID DIAGRAM STYLING
// =============================================================================
// Problem: Mermaid sets inline styles on SVG that constrain width.
// Solution: Override ALL possible width constraints at every level.
// Goal: Gray box expands to fit content, diagram centered inside, scrollbar on overflow.

// The pre > code wrapper - expand to fit content, allow scroll
.main-content pre:has(.mermaid),
.main-content pre:has(code.language-mermaid) {
  max-width: none !important;
  width: fit-content !important; // Expand to fit the SVG content
  min-width: 100% !important; // At least full container width
  overflow-x: auto !important;
  overflow-y: visible !important;
  display: block !important;
}

// Code block inside pre - also expand to fit
.main-content pre code.language-mermaid {
  display: block !important;
  width: fit-content !important; // Expand to fit content
  min-width: 100% !important; // At least full width
  max-width: none !important;
  padding: 1rem !important; // Add padding for visual spacing
  background: transparent !important;
  border: 0 !important;
  overflow: visible !important;
}

// Base Mermaid container - center the diagram
.mermaid {
  width: fit-content !important; // Size to content
  min-width: 100% !important; // At least full width of parent
  max-width: none !important;
  display: flex !important; // Use flex for centering
  justify-content: center !important; // Center the SVG horizontally
  align-items: center !important;
  margin: 1rem auto !important; // Center the container itself
  overflow: visible !important;
}

// Mermaid SVG - override ANY inline styles Mermaid sets
.mermaid svg,
.mermaid > svg,
svg[id^="mermaid-"] {
  display: block !important;
  max-width: none !important;
  width: auto !important;
  min-width: fit-content !important;
  height: auto !important;
  overflow: visible !important;
  margin: 0 auto !important; // Center SVG within mermaid container
}

// The g element inside SVG - ensure visible
.mermaid svg > g,
svg[id^="mermaid-"] > g {
  overflow: visible !important;
}

// General pre block styling
.main-content pre {
  width: 100%;
  overflow-x: auto;
}

// Mermaid in main content area - scrollable container
.main-content .mermaid {
  width: fit-content !important;
  min-width: 100% !important;
  max-width: none !important;
  display: flex !important;
  justify-content: center !important;
  margin: 1rem auto !important;
  padding: 0.5rem 0;
  overflow: visible !important;
}

// GitGraph specific styling
.mermaid .commit-label {
  text-anchor: start;
  dominant-baseline: middle;
  transform: translate(12px, 0);
}

// Ensure nodes and labels are visible
.mermaid svg .node rect,
.mermaid svg foreignObject {
  overflow: visible !important;
}
// Custom styles to optimize layout for large monitors
// Aggressive space utilization - minimize all padding and maximize content area

// BODY - Configure as flex container for proper sidebar + main layout
body {
  display: flex !important;
  flex-direction: row !important;
  min-height: 100vh !important;
}

// MAIN CONTENT - Use maximum width available
.main-content {
  max-width: none !important; // Remove default 800px limit
  width: 100% !important; // Use full available width
  padding-left: 1rem !important; // Minimal left padding
  padding-right: 0.625rem !important; // 10px right padding for better spacing
  padding-top: 1rem !important; // Top padding for content spacing
  margin-left: 0 !important;
  margin-right: 0 !important;
}

// MAIN CONTENT WRAPPER - Remove extra padding
.main-content-wrap {
  max-width: none !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

// PAGE WRAPPER - Remove margins
.page {
  max-width: none !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
}

// MAIN DIV - Use flexbox to fill remaining space, NO TOP PADDING for header alignment
.main,
#top,
div.main#top {
  flex: 1 1 auto !important; // Grow to fill remaining space after sidebar
  max-width: none !important;
  width: auto !important;
  margin: auto !important; // Match the actual rendered style
  margin-left: 0 !important;
  margin-right: 0 !important;
  padding-right: 0 !important;
  padding-left: 0.25rem !important; // Reduced to 4px (0.25rem)
  padding-top: 0 !important; // REMOVE top padding to align headers
  overflow-x: auto !important; // Handle overflow properly
  order: 0 !important; // Ensure main comes after sidebar (order: -1)
  position: relative !important; // Override any absolute positioning
  min-height: 100vh !important; // Full viewport height
  box-sizing: border-box !important;
}

// SIDEBAR - Fixed width, no flex growth, responsive sizing
.side-bar {
  flex: 0 0 160px !important; // Base width for medium screens
  width: 160px !important;
  min-width: 160px !important; // Override theme's 16.5rem (264px)
  max-width: 160px !important; // Enforce width constraint
  min-height: 100vh !important; // At least full viewport height
  height: auto !important; // Override theme's height: 100%, allow expansion
  overflow-y: auto !important; // Scroll if sidebar content overflows
  padding: 0 !important; // Remove all padding - header will have its own
  order: -1 !important; // Ensure sidebar appears first (left side)
  position: relative !important; // Override any absolute positioning
  flex-flow: column nowrap !important; // Maintain vertical layout
  align-items: stretch !important; // Stretch to fill width (not flex-end)
  
  // Larger screens get wider sidebar
  @media (min-width: 66.5rem) {
    flex: 0 0 180px !important;
    width: 180px !important;
    min-width: 180px !important;
    max-width: 180px !important;
  }
}

// SITE TITLE - Display inline with logo, allow text to wrap within fixed height
.site-title {
  padding-left: 0.25rem !important;
  padding-right: 0.25rem !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  margin-top: 0 !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
  line-height: 1.3 !important;
  min-height: 3.75rem !important;
  height: 3.75rem !important;
  max-height: 3.75rem !important;
  overflow: hidden !important;
  flex-grow: 1 !important;
  display: flex !important;
  align-items: center !important;
  flex-wrap: wrap !important;
}

// SITE LOGO - Consolidated styling for all logo selectors
// Handles both PNG and SVG formats with proper scaling
.site-logo,
.site-logo-img,
.site-logo img {
  height: 38px !important;
  width: auto !important;
  max-width: 240px !important;
  display: inline-flex !important;
  align-items: center !important;
  margin-right: 0 !important;
  padding: 0 !important;
  flex-shrink: 0 !important;
  object-fit: contain !important; // Maintain aspect ratio for both PNG and SVG
  vertical-align: middle !important;
}

// SITE TITLE TEXT - The actual text next to logo
.site-title-text {
  display: inline-block !important;
  vertical-align: middle !important;
  color: #f5f6fa !important;
  font-size: 0.875rem !important;
  font-weight: 600 !important;
  line-height: 1.3 !important;
  white-space: normal !important;
  word-wrap: break-word !important;
  max-width: calc(100% - 48px) !important; // Account for logo (38px) + spacing
  padding-left: 1rem !important;
  flex: 1 1 auto !important;
}

// SITE HEADER (in sidebar) - Force exact 3.75rem height to match main-header
.site-header {
  padding-left: 0.5rem !important;
  padding-right: 0.5rem !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
  margin-top: 0 !important;
  width: 100% !important;
  min-height: 3.75rem !important;
  height: 3.75rem !important;
  max-height: 3.75rem !important;
  display: flex !important;
  align-items: center !important;
  border-bottom: 1px solid #44434d !important;
  box-sizing: border-box !important;
}

// TOP HEADER BAR (search + view on github) - Align with sidebar header perfectly
.main-header,
#main-header {
  padding-left: 0.5rem !important;
  padding-right: 0.5rem !important;
  margin-top: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  height: 3.75rem !important; // Fixed height to match sidebar header
  background-color: #27262b !important;
  border-bottom: 1px solid #44434d !important;
  z-index: 0 !important;
  box-sizing: border-box !important;
}

// Main header direct child divs (search container)
.main-header > div {
  display: flex !important;
  align-items: center !important; // Vertically center search input
  height: 100% !important;
}

.site-nav,
.main-content-wrap > .site-header {
  padding-left: 0 !important;
  padding-right: 0 !important;
}

// SITE NAV - Remove all padding (#site-nav)
#site-nav,
.site-nav {
  padding: 0 !important;
  margin: 0 !important;
  width: 100% !important; // Inherit full width from sidebar
  max-width: 100% !important; // Don't exceed sidebar width
  box-sizing: border-box !important; // Include padding in width
}

// NAVIGATION - Tighter spacing
.nav-list {
  padding-left: 0.5rem !important;
  padding-right: 0.5rem !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}

.nav-list .nav-list-item {
  margin: 0.25rem 0 !important;
}

// NAVIGATION LINKS - Remove excessive padding
.nav-list .nav-list-item > a {
  padding: 0.25rem 0.5rem !important; // Minimal padding instead of 32px
}

// SEARCH BAR - No padding for tight alignment in main-header
.search {
  padding: 0 !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  display: flex !important;
  align-items: center !important;
  width: 100% !important;
}

.search-input-wrap {
  margin-left: 0 !important;
  margin-right: 0 !important;
  display: flex !important;
  align-items: center !important;
  width: 100% !important;
  height: auto !important; // Let it size naturally
}

.search-input,
#search-input {
  margin-left: 0 !important;
  margin-right: 0 !important;
  position: relative !important; // Override absolute positioning
  height: 2.5rem !important; // Fixed height for consistency
  width: 100% !important;
}

// Search results
.search-results {
  padding-left: 0.5rem !important;
  padding-right: 0.5rem !important;
}

// BREADCRUMBS - Minimize space
.breadcrumb-nav {
  margin-top: 0.5rem !important;
  margin-bottom: 0.5rem !important;
  padding-left: 0 !important;
}

// PAGE HEADER - Remove excessive padding
.page-header {
  padding-top: 0.5rem !important;
  padding-bottom: 0.5rem !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

// TITLES - Reduce spacing
.main-content h1:first-of-type {
  margin-top: 0.5rem !important;
}

.main-content h1,
.main-content h2,
.main-content h3 {
  margin-top: 1.5rem !important;
  margin-bottom: 0.75rem !important;
}

// HEADING ANCHOR LINKS - Ensure they stay within main content area
.main-content h1 > a.anchor,
.main-content h2 > a.anchor,
.main-content h3 > a.anchor,
.main-content h4 > a.anchor,
.main-content h5 > a.anchor,
.main-content h6 > a.anchor,
.main-content h1 > a.anchor-heading,
.main-content h2 > a.anchor-heading,
.main-content h3 > a.anchor-heading,
.main-content h4 > a.anchor-heading,
.main-content h5 > a.anchor-heading,
.main-content h6 > a.anchor-heading {
  left: -1.5rem !important; // Position to the left of heading
  margin-left: 0 !important; // Reset any margin
  text-decoration: none !important; // Remove underline
  border-bottom: none !important; // Remove any border underline
  border: none !important; // Remove all borders
  opacity: 0 !important; // Hidden by default
  transition: opacity 0.2s ease !important;
  
  &:hover {
    opacity: 1 !important; // Show on hover
  }
}

// Show anchor when hovering over heading
.main-content h1:hover > a.anchor,
.main-content h2:hover > a.anchor,
.main-content h3:hover > a.anchor,
.main-content h4:hover > a.anchor,
.main-content h5:hover > a.anchor,
.main-content h6:hover > a.anchor,
.main-content h1:hover > a.anchor-heading,
.main-content h2:hover > a.anchor-heading,
.main-content h3:hover > a.anchor-heading,
.main-content h4:hover > a.anchor-heading,
.main-content h5:hover > a.anchor-heading,
.main-content h6:hover > a.anchor-heading {
  opacity: 1 !important;
}

// Ensure headings have position: relative for anchor positioning
.main-content h1,
.main-content h2,
.main-content h3,
.main-content h4,
.main-content h5,
.main-content h6 {
  position: relative !important;
}

// ENHANCED HEADING STYLES FOR PHASES AND QUESTIONS
// Phase headers (h3) - Make them prominent with background and borders
.main-content h3 {
  background: linear-gradient(135deg, rgba(79, 70, 229, 0.15) 0%, rgba(99, 102, 241, 0.08) 100%) !important;
  border-left: 4px solid #6366f1 !important;
  padding: 1rem 1.25rem !important;
  margin-top: 2.5rem !important;
  margin-bottom: 1.25rem !important;
  border-radius: 6px !important;
  font-size: 1.5rem !important;
  font-weight: 700 !important;
  color: #e0e0ff !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.15) !important;
}

// Technology headings (h2) - Reuse phase styling for promoted sections
.main-content h2.tech-heading {
  background: linear-gradient(135deg, rgba(79, 70, 229, 0.15) 0%, rgba(99, 102, 241, 0.08) 100%) !important;
  border-left: 4px solid #6366f1 !important;
  padding: 1rem 1.25rem !important;
  margin-top: 2.5rem !important;
  margin-bottom: 1.25rem !important;
  border-radius: 6px !important;
  font-size: 1.5rem !important;
  font-weight: 700 !important;
  color: #e0e0ff !important;
  box-shadow: 0 2px 8px rgba(99, 102, 241, 0.15) !important;
}

// Question headers (h4) - Distinctive styling with icon-like appearance
.main-content h4 {
  background: rgba(139, 92, 246, 0.12) !important;
  border-left: 3px solid #8b5cf6 !important;
  padding: 0.75rem 1rem !important;
  margin-top: 1.75rem !important;
  margin-bottom: 1rem !important;
  border-radius: 4px !important;
  font-size: 1.15rem !important;
  font-weight: 600 !important;
  color: #ddd6fe !important;
  box-shadow: 0 1px 4px rgba(139, 92, 246, 0.1) !important;
}

// Special styling for "Decision Gate" and "Decision Criteria" headers
.main-content h4:contains("Decision"),
.main-content h4[id*="decision"] {
  background: rgba(236, 72, 153, 0.12) !important;
  border-left-color: #ec4899 !important;
  color: #fce7f3 !important;
}


// PARAGRAPHS - Tighter spacing
.main-content p {
  margin-bottom: 0.75rem !important;
  line-height: 1.7 !important;
}

// Enhanced styling for decision path paragraphs (bold questions with arrows)
.main-content p strong {
  color: #a5b4fc !important; // Brighter indigo for questions
  font-weight: 600 !important;
}

// Paragraphs immediately after h4 headings (decision paths)
.main-content h4 + p {
  margin-top: 0.5rem !important;
  padding-left: 1rem !important;
  border-left: 2px solid rgba(139, 92, 246, 0.3) !important;
  padding-top: 0.5rem !important;
  padding-bottom: 0.5rem !important;
}

// LISTS - Reduce spacing and improve hierarchy
.main-content ul,
.main-content ol {
  margin-bottom: 0.75rem !important;
  padding-left: 1.5rem !important;
}

// List items with better spacing
.main-content li {
  margin-bottom: 0.5rem !important;
  line-height: 1.6 !important;
}

// Nested lists
.main-content ul ul,
.main-content ol ul,
.main-content ul ol,
.main-content ol ol {
  margin-top: 0.5rem !important;
  margin-bottom: 0.5rem !important;
  padding-left: 1.25rem !important;
}

// List items under h4 headings (like the dimension questions)
.main-content h4 + ul,
.main-content h4 + ol {
  background: rgba(100, 100, 100, 0.05) !important;
  padding: 1rem 1rem 1rem 2rem !important;
  border-radius: 4px !important;
  margin-top: 0.75rem !important;
  margin-bottom: 1rem !important;
}

// Arrow symbol styling in decision paths
.main-content p:contains("→"),
.main-content li:contains("→") {
  color: #e0e0e0 !important;
}


// TABLES - Full width with professional styling
.main-content table {
  width: 100% !important;
  max-width: 100% !important;
  border-collapse: collapse !important;
  margin: 1.5rem 0 !important;
  font-size: 0.9rem !important;
  line-height: 1.5 !important;
}

// Table headers - bold and styled
.main-content table thead th {
  background-color: rgba(100, 100, 100, 0.15) !important;
  font-weight: 700 !important;
  text-align: left !important;
  padding: 0.75rem 1rem !important;
  border-bottom: 2px solid rgba(150, 150, 150, 0.3) !important;
  vertical-align: top !important;
}

// Table cells - consistent padding and alignment
.main-content table td {
  padding: 0.65rem 1rem !important;
  border-bottom: 1px solid rgba(150, 150, 150, 0.2) !important;
  vertical-align: top !important;
  text-align: left !important;
}

// Zebra striping for readability
.main-content table tbody tr:nth-child(even) {
  background-color: rgba(100, 100, 100, 0.05) !important;
}

// Hover effect for rows
.main-content table tbody tr:hover {
  background-color: rgba(100, 100, 100, 0.1) !important;
}

// AUTOMATIC COLUMN WIDTHS - Let content determine size
// Tables will autosize based on content with proper wrapping
.main-content table thead th,
.main-content table tbody td {
  width: auto !important; // Auto-size columns based on content
  white-space: normal !important; // Allow text wrapping
}

// Links in tables - make them visible
.main-content table a {
  color: #4a9eff !important; // Bright blue for dark mode
  text-decoration: none !important;
  &:hover {
    text-decoration: underline !important;
  }
}

// Bold text in tables
.main-content table strong,
.main-content table b {
  font-weight: 700 !important;
  color: #e0e0e0 !important; // Brighter in dark mode
}

// Code in tables
.main-content table code {
  background-color: rgba(150, 150, 150, 0.2) !important;
  padding: 0.2rem 0.4rem !important;
  border-radius: 3px !important;
  font-size: 0.85em !important;
}

// Ensure text wraps properly in cells
.main-content table td,
.main-content table th {
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  hyphens: auto !important;
}

// CODE BLOCKS - Full width, but don't constrain Mermaid
.main-content pre {
  max-width: 100%;
  margin: 0.75rem 0 !important;
  overflow-x: auto;
}

// Override for Mermaid-containing pre blocks
.main-content pre:has(.mermaid) {
  max-width: none !important;
  overflow: visible !important;
}

// CODE INLINE - Better visibility
.main-content code {
  background-color: rgba(150, 150, 150, 0.25) !important;
  padding: 0.2rem 0.4rem !important;
  border-radius: 3px !important;
  font-size: 0.9em !important;
  color: #c7d2fe !important;
  border: 1px solid rgba(150, 150, 150, 0.3) !important;
}

// BLOCKQUOTES - Enhanced styling
.main-content blockquote {
  border-left: 4px solid #6366f1 !important;
  background: rgba(99, 102, 241, 0.08) !important;
  padding: 0.75rem 1rem !important;
  margin: 1rem 0 !important;
  border-radius: 4px !important;
}

// EMOJI AND ICONS - Better visibility
.main-content {
  // Emoji in lists
  li:first-child::before {
    font-size: 1.1em !important;
  }
}

// HORIZONTAL RULES - More visible separators
.main-content hr {
  border: 0 !important;
  height: 2px !important;
  background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.5), transparent) !important;
  margin: 2rem 0 !important;
}

// LINKS - Better contrast
.main-content a {
  color: #7dd3fc !important;
  text-decoration: none !important;
  border-bottom: 1px solid rgba(125, 211, 252, 0.3) !important;
  transition: all 0.2s ease !important;
  
  &:hover {
    color: #bae6fd !important;
    border-bottom-color: rgba(186, 230, 253, 0.6) !important;
  }
}

// EMPHASIS - Bold text needs to stand out more
.main-content strong,
.main-content b {
  font-weight: 700 !important;
  color: #f0f0f5 !important;
}


// FOOTER - Minimal spacing and hide theme credit
.site-footer {
  margin-top: 1.5rem !important;
  padding: 1rem !important;
}

// Hide "This site uses Just the Docs" text
.site-footer p {
  display: none !important;
}

// HIDE SIDEBAR FOOTER COMPLETELY (body > div.side-bar > footer)
.side-bar > footer,
.side-bar footer {
  display: none !important;
}

// REMOVE AUX LINKS PADDING
.aux-nav {
  padding-top: 0.5rem !important;
  padding-right: 0.5rem !important;
}

// Ensure content stretches to fill available space
@media (min-width: 50rem) {
  .main-content-wrap {
    max-width: none !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    margin-right: 0 !important;
  }
}

// Remove default container constraints
.container,
.container-lg,
.container-xl {
  max-width: none !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

// Override any wrapper divs adding padding
.site-nav,
.navigation,
.nav-category {
  padding-left: 0.5rem !important;
  padding-right: 0.5rem !important;
}

// Remove extra spacing from nav list
.nav-list-item .nav-list {
  padding-left: 1rem !important; // Just enough for hierarchy
}

// Top-level page header in main content area
.main-content > .page-header {
  padding-left: 0 !important;
  padding-right: 0 !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
}

// Site wrapper - ensure proper layout
.site {
  padding-right: 0 !important;
  margin-right: 0 !important;
}

// Main wrapper - extend to full viewport
.wrap,
.wrapper {
  max-width: 100vw !important;
  padding-right: 0 !important;
  margin-right: 0 !important;
}

// Footnote and reference styling to reduce visual prominence near navigation links
.footnotes {
  border-top: 1px solid #3a3a45 !important;
  margin-top: 2.5rem !important;
  padding-top: 1rem !important;
  font-size: 0.8rem !important;
  color: #9ba3af !important;
}

.footnotes::before {
  content: "References";
  display: block;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #7dd3fc;
  margin-bottom: 0.5rem;
}

.footnotes ol {
  margin-left: 1.25rem !important;
}

.footnotes p {
  margin-bottom: 0.4rem !important;
}

sup a.footnote {
  font-size: 0.6rem !important;
  color: #7dd3fc !important;
}

sup a.footnote:hover,
sup a.footnote:focus {
  color: #38bdf8 !important;
}
